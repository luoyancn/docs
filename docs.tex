%\RequirePackage[2020-02-02]{latexrelease}
% openany可以去除章节之间的空白页
%\documentclass[b5paper,openany,twoside]{book}

\documentclass[newfloat,tikz,usenames,dvipsnames,svgnames,table,b5paper,cache=false]{book}
\usepackage{xcolor}
\usepackage{ifthen}
\usepackage{graphicx}
\usepackage{minted}
\usepackage{xeCJK}
% 中文字体下划线支持
\usepackage{xeCJKfntef}
\usepackage{indentfirst}
\usepackage{fancyhdr}
\usepackage{float}
\usepackage{pifont}
\usepackage{geometry}
% hyperref之前
\usepackage{hyperref}
\usepackage[utf8]{inputenc}
\usepackage{caption}
%\usepackage{tabularx}
\usepackage{ltablex}
\usepackage{bclogo,rotating}
%\usepackage{mdframed}
\usepackage{tikz}
\usepackage{pgf}
\usepackage{enumerate}
\usepackage{outlines}
%\usepackage{enumitem}
\usepackage{verbatim}
\usepackage{attachfile2}
% 用于处理过长url
\usepackage{xurl}
\usepackage{charter}
\usepackage[most]{tcolorbox}
\usepackage[explicit]{titlesec}
\usepackage{titletoc}
% 设置minted字体
\usepackage{fontspec}
% 每页的脚注重新编号
\usepackage{perpage}
\usepackage{chngcntr}
\usepackage{afterpage}
\usepackage{eso-pic}
\usepackage{calligra}
\usepackage{metalogo}

% 直接使用svg图片
\usepackage[inkscapearea=page]{svg}

% 页面水印的一种实现方式，但与新版本的(>=2021)的latex不兼容
%\usepackage[printwatermark]{xwatermark}
\usepackage{pagecolor}

% 设置页面颜色
\pagecolor{yellow!8!white}

% 每页的脚注重新编号
% 强制脚注和引用在相同页，需要使用footnote，不能使用footmark
\MakePerPage{footnote}
\counterwithout*{footnote}{chapter}

\tcbuselibrary{skins,fitting,minted}
\usetikzlibrary{matrix,fit,chains,calc,scopes,arrows,
                decorations.pathmorphing,backgrounds,
                positioning,petri,automata}
%\tikzset{font=\tiny}
\definecolor{yellow1}{rgb}{1,0.8,0.2}
\DeclareGraphicsRule{.mps}{eps}{.mps}{}
\definecolor{lbcolor}{rgb}{0.9,0.9,0.9}
% \usemintedstyle{tango}
% 设置minted字体
\setmonofont{CodeNewRoman Nerd Font Mono}
% 显示tree的输出(特殊字符)
%\setmonofont{CMU Typewriter Text}
\hypersetup{%
    % 对书签进行编号
    bookmarksnumbered=true,
    bookmarks=true,
    % 设置文档属性的标题
    pdftitle={综合手册},
    % 设置文档属性的作者
    pdfauthor={luciferchn@gmail.com},
    pdfborder={0 0 0},
    pdfsubject={Latex, Rust, OS, Linux},
    pdfkeywords={Latex, Rust, OS, Linux},
    colorlinks=true,
    linkcolor=black,
    citecolor=green,
    filecolor=green,
    urlcolor=cyan!50!black!90
}

%\newcommand{\colorunderlineref}[1]{{\color{RedOrange} \dunderline{1pt}{\colorunderlineref{#1}}}}
%\newcommand{\colorunderline}[1]{{\color{WildStrawberry} \dunderline{1pt}{#1}}}
% 中文的文字背景色块
\newcommand{\colorblock}[1]{\CJKsout*[thickness=2.5ex, format=\color{WildStrawberry}]{#1}}
% 中文下划线
\newcommand{\colorunderline}[1]{\CJKunderline[thickness=0.5ex, format=\color{WildStrawberry},skip=false]{#1}}
% nameref颜色的单独设置，可以与目录区的linkcolor区分开
\newcommand{\colorunderlineref}[1]{\hypersetup{linkcolor=RedOrange}\nameref{#1}\hypersetup{linkcolor=black}}

\newcommand\BackgroundPic{%
\put(0,0){%
\parbox[b][\paperheight]{\paperwidth}{%
\vfill
\centering
\includegraphics[width=\paperwidth,keepaspectratio]{7.png}
\vfill
}}}

% 设置字体
\setmainfont{Times New Roman}
%\setmainfont{CodeNewRoman Nerd Font Mono}
%宋体
%\setCJKmainfont{SimSun}
% 华文新楷
%\setCJKmainfont{STXINGKA.TTF}
%\setCJKmainfont{方正硬笔行书简体.ttf}
\setCJKmainfont{方正北魏楷书简体.ttf}
% 设置页边距
%\geometry{left=2.5cm,right=2.5cm,top=2.4cm,bottom=2.4cm}
% 设置页边距，包括脚注
\geometry{includefoot,top=2.4cm,bottom=2.4cm}
% 修改图注为 图1-1 xxx
% 修改表注为 表1-1 xxx
\renewcommand{\figurename}{图}
\renewcommand{\tablename}{表}
\renewcommand {\thetable} {\thechapter{}-\arabic{table}}
\renewcommand {\thefigure} {\thechapter{}-\arabic{figure}}
% 增加对代码的引用支持，实现类似图表一样的引用链接
\newenvironment{sourcecode}{\captionsetup{type=listing}}{}
% 修改代码引用标记
\SetupFloatingEnvironment{listing}{name=代码段}
% 修改代码的题注和序号
\renewcommand {\thelisting} {\thechapter{}-\arabic{listing}}

% 去除冒号
\captionsetup{labelformat=default,labelsep=space}
% 修改图注和标注的字体大小
\captionsetup{font={small}}

\definecolor{DarkGray}{gray}{0.2}
\definecolor{doc}{RGB}{105,105,105}
\definecolor{mybluei}{RGB}{105,105,105}
\definecolor{myblueii}{RGB}{105,105,105}
\newcommand\ChapterFont{\rmfamily\selectfont\huge}
\newcommand\SectionFont{\bfseries\rmfamily\selectfont\Large}

%~~~~~~~~~~~~~~~~~章设置~~~~~~~~~~~~~~~~~~~~~~
\titleformat{\chapter}[block]
 {\normalfont\ChapterFont\huge\color{myblueii}}%\raisebox{-0.6\height}
 {\tcbset{colframe=mybluei, boxrule=0.8pt, left=0pt, right=0pt, top=0pt, bottom=0pt}\raisebox{-0.48\height}{\rotatebox{90}{\tcbox[boxsep=4pt, colback= white ]{\color{mybluei}\Large\chaptertitlename}}}\hskip 0.25em\mbox{\tcbox[ boxsep=12pt, colback=mybluei, tcbox raise = -35pt]{\color{white}\bfseries\fontsize{70}{70}\selectfont\thechapter}}}
 {0.5em}
 {#1\vskip0.6ex\endgraf\titlerule[1ex]}[]

 \titleformat{name=\chapter,numberless}[block]
 {\normalfont\selectfont\huge\color{myblueii}}
 {}
 {0pt}
 {\parbox[b]{70pt}{\mbox{}}%
 \hspace{15pt}%
 \parbox[b]{\dimexpr\textwidth-15pt}{%
 \raggedright\bfseries#1\vskip6pt%
 }%
 }
 \titleformat{\section}
 {\normalfont\small\sffamily\SectionFont\color{myblueii}}
 {\colorbox{mybluei}{%
        \parbox[c][16pt][c]{40pt}{%
            \centering\textcolor{white}{\SectionFont\Large\rmfamily\thesection}%
        }%
    }%
 }
 {1em}
 {#1}
% [\vspace{-0.755\baselineskip}%
% \color{myblueii}\hspace*{\dimexpr40pt+2\fboxsep\relax}%
% \rule{\dimexpr\textwidth-40pt-2\fboxsep\relax}{1pt}%
% ]

%~~~~~~~~~~~~~~~~~节设置~~~~~~~~~~~~~~~~~~~~~~
%\titleformat{\section}[block]
%  {\normalfont\huge\bfseries}
%  {\tikz\node[
%      font=\huge\bfseries\color{white},
%      fill=gray!50,
%      rounded corners=20pt,
%      minimum height=1.6cm,
%      text width=3em,
%      align=center,
%      inner xsep=0pt] {\parbox{1.5em}{\thesection\hfill}};%
%  }
%  {-1em}
%  {\tikz\node[
%      fill=gray,
%      font=\Large\sffamily\color{white},
%      minimum height=1.6cm,
%      text width=\the\dimexpr\textwidth-40pt-\fboxsep\relax,
%      align=center,inner xsep=0pt] {#1};%
%  }

%\newwatermark[oddpages,scale=3,xpos=-52,ypos=-80]{\includegraphics[scale=0.05]{nero.png}}
%\newwatermark[oddpages,scale=3,xpos=44,ypos=-80]{\includegraphics[scale=0.08]{bb.png}}
%\newwatermark[evenpages,scale=3,xpos=-42,ypos=-80]{\includegraphics[scale=0.08]{bb.png}}
%\newwatermark[evenpages,scale=3,xpos=54,ypos=-80]{\includegraphics[scale=0.08]{jad.png}}

%\newsavebox\mybox
%\savebox\mybox{\tikz[color=red,opacity=0.3]\node{\includegraphics[scale=0.08]{bb.png}};}
%\newwatermark*[
%  allpages,
%  scale=6,
%  xpos=-20,
%  ypos=15
%]{\usebox\mybox}

% 适用于xwatermark的水印方式
%\newsavebox\bbbox
%\savebox\bbbox{\tikz[opacity=0.5]\node{\includegraphics[scale=0.08]{bb.png}};}
%
%\newsavebox\nerobox
%\savebox\nerobox{\tikz[opacity=0.5]\node{\includegraphics[scale=0.2]{nero.png}};}
%
%\newsavebox\scathachbox
%\savebox\scathachbox{\tikz[opacity=0.5]\node{\includegraphics[scale=0.011]{scathach.png}};}
%
%\newsavebox\yuibox
%\savebox\yuibox{\tikz[opacity=0.5]\node{\includegraphics[scale=0.1]{takamura_yui.png}};}

%\pagestyle{fancy}
%\fancyhf{}
%\fancyhead[RE,LO]{综合手册}
%\fancyhead[LE,RO]{\includegraphics[scale=0.08]{vim.png}}
%\renewcommand{\headrulewidth}{0.5pt}
%\renewcommand{\footrulewidth}{0.5pt}
%\cfoot{\thepage}
%
%% 设置chapter章节页的页眉页脚
%\fancypagestyle{plain}{
%    \fancyhf{}
%    \fancyhead[RE,LO]{综合手册}
%    \fancyhead[LE,RO]{\includegraphics[scale=0.08]{vim.png}}
%    \renewcommand{\headrulewidth}{0.5pt}
%    \renewcommand{\footrulewidth}{0.5pt}
%    \cfoot{\thepage}
%}

% 设置代码段格式。只使用minted，会出现代码过长无法显示，也会出现代码无法分页的情况
% 配合mdframed则不会出现这些问题
% breaklines表示自动换行
%\newenvironment{code-block}[1]
% {\VerbatimEnvironment
%  \begin{mdframed}[topline=false, bottomline=false, leftline=false,
%                   rightline=false, backgroundcolor=lbcolor,
%                   userdefinedwidth=\textwidth]
%  \begin{minted}[fontsize=\scriptsize,linenos=false,breaklines=true,breakanywhere,breaksymbolleft=,breakanywheresymbolpre=,]{#1}}
% {\end{minted}\end{mdframed}}

% 删除minted代码块当中错误代码所引起的红色边框
%\AtBeginEnvironment{minted}{\dontdofcolorbox}
%\def\dontdofcolorbox{\renewcommand\fcolorbox[4][]{##4}}
% 另一种删除由于错误代码所引起的红色边框，影响范围较大，可用于minted，inputminted，mintedline等
\renewcommand{\fcolorbox}[4][]{#4}

\newtcblisting{code-block}[1]
{beamer,colback=yellow!8!white,colframe=black,listing only,breakable, width=\linewidth,
 %underlay={\begin{tcbclipinterior}
 %\shade[inner color=black!80!white,outer color=yellow!10!white]
 %(interior.north east) circle (1cm);
 %\draw[help lines,step=1cm,yellow!40!black,shift={(interior.north west)}]
 %(interior.south west) grid (interior.north east);
 %\end{tcbclipinterior}},
 listing engine=minted, minted language={#1},
 minted options={fontsize=\scriptsize,linenos=false,breaklines=true,
 breakanywhere,breaksymbolleft=,breakanywheresymbolpre=,}}

% 设置单行代码样式，当页面宽度不够时，bgcolor参数将影响换行操作
\newcommand{\codeinlinebg}[1]{\mintinline[bgcolor=lbcolor,]{#1}}
% 无bgcolor，将不影响单行代码的换行操作
\newcommand{\codeinline}[1]{\mintinline[breaklines=true,breakanywhere,breaksymbolleft=,breakanywheresymbolpre=,]{#1}}

%% 设置警示表格
%\newenvironment{warning}
%  {\par\begin{mdframed}[linewidth=2pt,linecolor=black]%
%    \begin{list}{}{\leftmargin=1cm
%                   \labelwidth=\leftmargin}\item[\color{red} \Large\ding{43}]}
%  {\end{list}\end{mdframed}\par}

% 设置另外一种警示框模式
%\newenvironment{attention}
%{\par\parshape0 \linewidth\textwidth
%\par\medskip\noindent
%\begin{tikzpicture}
%  \node[inner sep = 0pt] (box) \bgroup
%  \begin{minipage}[t]{.99\textwidth}
%    \begin{minipage}{.3\textwidth}
%    \centering
%    \tikz[scale = 5]\node[scale = 3, rotate = 30]{\bclampe};
%    \end{minipage}%
%    \begin{minipage}{.65\textwidth}
%    \surroundwithmdframed{}}
%    {\end{minipage}\hfill
%  \end{minipage}
%  \egroup;
%  \draw[black,line width=3pt]
%    ( $ (box.north east) + (-5pt,3pt) $ ) -- ( $ (box.north east) + (0,3pt) $ ) -- ( $ (box.south east) + (0,-3pt) $ ) -- + (-5pt,0);
%  \draw[black,line width=3pt]
%    ( $ (box.north west) + (5pt,3pt) $ ) -- ( $ (box.north west) + (0,3pt) $ ) -- ( $ (box.south west) + (0,-3pt) $ ) -- + (5pt,0);
%\end{tikzpicture}
%\par\medskip}

%\newenvironment{note}
%{\par\parshape0 \linewidth\textwidth
%\par\medskip\noindent
%\begin{tikzpicture}
%  \node[inner sep = 0pt] (box) \bgroup
%  \begin{minipage}[t]{.99\textwidth}
%    \begin{minipage}{.3\textwidth}
%    \centering
%    \tikz[scale = 5]\node[scale = 3]{\bcplume};
%    \end{minipage}%
%    \begin{minipage}{.65\textwidth}
%    \surroundwithmdframed{}}
%    {\end{minipage}\hfill
%  \end{minipage}
%  \egroup;
%  \draw[black,line width=3pt]
%    ( $ (box.north east) + (-5pt,3pt) $ ) -- ( $ (box.north east) + (0,3pt) $ ) -- ( $ (box.south east) + (0,-3pt) $ ) -- + (-5pt,0);
%  \draw[black,line width=3pt]
%    ( $ (box.north west) + (5pt,3pt) $ ) -- ( $ (box.north west) + (0,3pt) $ ) -- ( $ (box.south west) + (0,-3pt) $ ) -- + (5pt,0);
%\end{tikzpicture}
%\par\medskip}

%\newenvironment{warn}
%{\par\parshape0 \linewidth\textwidth
%\par\medskip\noindent
%\begin{tikzpicture}
%  \node[inner sep = 0pt] (box) \bgroup
%  \begin{minipage}[t]{.99\textwidth}
%    \begin{minipage}{.3\textwidth}
%    \centering
%    \tikz[scale = 5]\node[scale = 3, rotate = -14]{\bcattention};
%    \end{minipage}%
%    \begin{minipage}{.65\textwidth}
%    \surroundwithmdframed{}}
%    {\end{minipage}\hfill
%  \end{minipage}
%  \egroup;
%  \draw[orange,line width=3pt]
%    ( $ (box.north east) + (-5pt,3pt) $ ) -- ( $ (box.north east) + (0,3pt) $ ) -- ( $ (box.south east) + (0,-3pt) $ ) -- + (-5pt,0);
%  \draw[orange,line width=3pt]
%    ( $ (box.north west) + (5pt,3pt) $ ) -- ( $ (box.north west) + (0,3pt) $ ) -- ( $ (box.south west) + (0,-3pt) $ ) -- + (5pt,0);
%\end{tikzpicture}
%\par\medskip}
%
%\newenvironment{critical}
%{\par\parshape0 \linewidth\textwidth
%\par\medskip\noindent
%\begin{tikzpicture}
%  \node[inner sep = 0pt] (box) \bgroup
%  \begin{minipage}[t]{.99\textwidth}
%    \begin{minipage}{.3\textwidth}
%    \centering
%    \tikz[scale = 5]\node[scale = 3]{\bcstop};
%    \end{minipage}%
%    \begin{minipage}{.65\textwidth}
%    \surroundwithmdframed{}}
%    {\end{minipage}\hfill
%  \end{minipage}
%  \egroup;
%  \draw[red,line width=3pt]
%    ( $ (box.north east) + (-5pt,3pt) $ ) -- ( $ (box.north east) + (0,3pt) $ ) -- ( $ (box.south east) + (0,-3pt) $ ) -- + (-5pt,0);
%  \draw[red,line width=3pt]
%    ( $ (box.north west) + (5pt,3pt) $ ) -- ( $ (box.north west) + (0,3pt) $ ) -- ( $ (box.south west) + (0,-3pt) $ ) -- + (5pt,0);
%\end{tikzpicture}
%\par\medskip}

%\newenvironment{_inner_note_}
%{\begin{wrapfigure}{l}{0.25\textwidth}
%\begin{tikzpicture}
%\centering
%\node[scale = 3]{\bcplume};
%\end{tikzpicture}
%\end{wrapfigure}
%\noindent\surroundwithmdframed{}}
%
%\newenvironment{note}
%  {\begin{tcolorbox}[colframe=blue!10!green,colback=green!10!white]\par\parshape0 \linewidth\textwidth \par\medskip\noindent\begin{_inner_note_}}
%  {\end{_inner_note_}\end{tcolorbox}\par\medskip}
%
%\newenvironment{_inner_attention_}
%{\begin{wrapfigure}{l}{0.25\textwidth}
%\begin{tikzpicture}
%\centering
%\node[scale = 3]{\bclampe};
%\end{tikzpicture}
%\end{wrapfigure}
%\noindent\surroundwithmdframed{}}
%
%\newenvironment{attention}
%  {\begin{tcolorbox}[colframe=blue!10!green,colback=green!10!white]\par\parshape0 \linewidth\textwidth \par\medskip\noindent\begin{_inner_attention_}}
%  {\end{_inner_attention_}\end{tcolorbox}\par\medskip}
%
%\newenvironment{_inner_warning_}
%{\begin{wrapfigure}{l}{0.25\textwidth}
%\begin{tikzpicture}
%\centering
%\node[scale = 3]{\bcattention};
%\end{tikzpicture}
%\end{wrapfigure}
%\noindent\surroundwithmdframed{}}
%
%\newenvironment{warn}
%  {\begin{tcolorbox}[colframe=blue!10!green,colback=green!10!white]\par\parshape0 \linewidth\textwidth \par\medskip\noindent\begin{_inner_warning_}}
%  {\end{_inner_warning_}\end{tcolorbox}\par\medskip}
%
%\newenvironment{_inner_critical_}
%{\begin{wrapfigure}{l}{0.25\textwidth}
%\begin{tikzpicture}
%\centering
%\node[scale = 3]{\bcstop};
%\end{tikzpicture}
%\end{wrapfigure}
%\noindent\surroundwithmdframed{}}
%
%\newenvironment{critical}
%  {\begin{tcolorbox}[colframe=blue!10!green,colback=green!10!white]\par\parshape0 \linewidth\textwidth \par\medskip\noindent\begin{_inner_critical_}}
%  {\end{_inner_critical_}\end{tcolorbox}\par\medskip}

\newenvironment{note}
 {\begin{tcolorbox}[beamer,colframe=black!40!green,colback=green!20!white,lower separated=false,sidebyside gap=5mm, sidebyside,lefthand width=1.5cm,segmentation engine=empty]
   {\tikz[scale = 2]\node[scale = 2]{\bcplume};}
   \tcblower}
 {\end{tcolorbox}}

\newenvironment{attention}
 {\begin{tcolorbox}[beamer,colframe=black!40!green,colback=green!20!white,lower separated=false,sidebyside gap=5mm, sidebyside,lefthand width=1.5cm,segmentation engine=empty]
   {\tikz[scale = 2]\node[scale = 2]{\bclampe};}
   \tcblower}
 {\end{tcolorbox}}

\newenvironment{warn}
 {\begin{tcolorbox}[beamer,colframe=orange!50!black,colback=orange!40!white,lower separated=false,sidebyside gap=5mm, sidebyside,lefthand width=1.5cm,segmentation engine=empty]
   {\tikz[scale = 2]\node[scale = 2]{\bcattention};}
   \tcblower}
 {\end{tcolorbox}}

\newenvironment{critical}
 {\begin{tcolorbox}[beamer,colframe=red!40!green,colback=red!20!white,lower separated=false,sidebyside gap=5mm, sidebyside,lefthand width=1.5cm,segmentation engine=empty]
   {\tikz[scale = 2]\node[scale = 2]{\bcstop};}
   \tcblower}
 {\end{tcolorbox}}

% 设置着色提示框
%\begin{comment}
%\tcbset{textmarker/.style={%
%        enhanced,
%        parbox=false,boxrule=0mm,boxsep=0mm,arc=0mm,
%        outer arc=0mm,left=3mm,right=3mm,top=7pt,bottom=7pt,
%        toptitle=1mm,bottomtitle=1mm}}
%\newtcolorbox{hintBox}{textmarker,borderline west={6pt}{0pt}{yellow},colback=yellow!10!white}
%\newtcolorbox{importantBox}{textmarker,borderline west={6pt}{0pt}{red},colback=red!10!white}
%\newtcolorbox{noteBox}{textmarker,borderline west={6pt}{0pt}{green},colback=green!10!white}
%% 普通的着色提示框
%\newcommand{\note}[1]{\begin{noteBox} \textbf{Note:} #1 \end{noteBox}}
%% 普通的着色警示框
%\newcommand{\warn}[1]{\begin{hintBox} \textbf{Warning:} #1 \end{hintBox}}
%% 普通的着色严重框
%\newcommand{\important}[1]{\begin{importantBox} \textbf{Important:} #1 \end{importantBox}}
%\end{comment}

% 设置目录层级，默认只到subsection，设置4可以到subsubsection
\setcounter{tocdepth}{4}
% 设置针对subsubsection进行编号
\setcounter{secnumdepth}{4}

\begin{document}

%\begin{titlepage}
%    \centering{
%    {\fontsize{40}{48}\selectfont 综合手册} }\\
%    \vspace{\fill}
%    \centering{\Large{luciferchn@gmail.com}}\\
%    \vspace{80mm}
%\end{titlepage}

% 设置封面
\begin{titlepage}
  % 单独设置封面的页面布局（页边距）
  \newgeometry{margin=1.8cm,top=2.4cm,bottom=2.4cm}
  \AddToShipoutPicture*{\BackgroundPic}
  \centering
  \begin{tcolorbox}[boxrule=6pt, colframe=OliveGreen, height=\textheight, width=\textwidth,enhanced,tikz={opacity=0.5,transparency group}]
  {
    \begin{center}
      \vspace*{0.14\textheight}
      \fontsize{45}{45}\scshape 综合手册\\
      \vspace*{0.018\textheight}
      \vspace*{0.1\textheight}
      \vspace*{0.3\textheight}
      {\fontsize{12}{12}\calligra Experience of\\}
      \fontsize{28}{28}\scshape luciferchn@gmail.com\\
      \vspace*{0.1\textheight}
      \centering
      \begin{tikzpicture}[start chain=main going right,]
        \node[on chain,align=center,draw=none](a1){{\fontsize{12}{12}\calligra Designed by} \\
        {\Large \LaTeX}
        };
        {
          [start branch=A going below]
          \node[on chain,align=center,draw=none,scale=0.01](d1){};
          \node[on chain,align=center,draw=none,](d2){};
        }
        \node[on chain,align=center,draw=none](a2){};
        {
          [start branch=B going below]
          \node[on chain,align=center,draw=none,scale=0.01](s1){};
          \node[on chain,align=center,draw=none,](s2){};
          }
        \node[on chain,align=center,draw=none](a3){{\fontsize{12}{12}\calligra Compiled by} \\
        {\Large \XeLaTeX}
        };
        {
          [start branch=C going below]
          \node[on chain,align=center,draw=none,scale=0.01](e1){};
          \node[on chain,align=center,draw=none,](e2){};
        }
      \end{tikzpicture}
    \end{center}
  }
  \end{tcolorbox}
\end{titlepage}
% 恢复原本设定的页面布局
{
\pagestyle{empty}
\clearpage\mbox{}\clearpage
}

%\newpage
% 去除目录前后的空白页
%\let\cleardoublepage\clearpage

% xwatermark实现水印的方式
%\newwatermark*[oddpages,scale=6,xpos=60,ypos=-80]{\usebox\bbbox}
%\newwatermark*[oddpages,scale=6,xpos=-60,ypos=-88]{\usebox\yuibox}
%
%\newwatermark*[evenpages,scale=5,xpos=-52,ypos=-86]{\usebox\nerobox}
%\newwatermark*[evenpages,scale=5,xpos=50,ypos=-86]{\usebox\scathachbox}

% 使用eso-pic实现水印的方式，与多数版本的latex兼容
\AddToShipoutPictureFG{%
  \put(\LenToUnit{-0.2cm},0){
    \begin{tikzpicture}
    \node [opacity=0.5]{
      \ifodd\value{page}
        \includegraphics[scale=0.08]{yui.png}
      \fi
    };
    \end{tikzpicture}
  }
}

\AddToShipoutPictureFG{%
  \put(\LenToUnit{0.6cm},0){
    \begin{tikzpicture}
    \node [opacity=0.5]{
      \ifodd\value{page}
      \else
        \includegraphics[scale=0.3]{nero.png}
      \fi
    };
    \end{tikzpicture}
  }
}

\AddToShipoutPictureFG{
  \put(\LenToUnit{\dimexpr \paperwidth-6cm},0)
  {
    \begin{tikzpicture}
    \node [opacity=0.5]{
      \ifodd\value{page}
        \includegraphics[scale=0.58]{bb.png}
      \fi
    };
    \end{tikzpicture}
  }
}

\AddToShipoutPictureFG{
  \put(\LenToUnit{\dimexpr \paperwidth-5cm},0)
  {
    \begin{tikzpicture}
    \node [opacity=0.5]{
      \ifodd\value{page}
      \else
        \includegraphics[scale=0.07]{scathach.png}
      \fi
    };
    \end{tikzpicture}
  }
}

\frontmatter
{
  \renewcommand*\contentsname{目录}
  % 将目录加入到书签当中
  \addtocontents{toc}{\protect{\pdfbookmark[0]{\contentsname}{toc}}}
  \tableofcontents%
  % 不在目录页显示页眉页脚
  \thispagestyle{empty}
}

\afterpage{\restoregeometry}
% 页码从正文开始计算，不从目录开始
\mainmatter

% 对代码段添加引用的示例
% \begin{sourcecode}
% \begin{code-block}{rust}
% #[derive(Debug, Builder)]
% pub struct Command {
%     executable: String,
%     args: Vec<String>,
%     env: Vec<String>,
%     current_dir: String,
% }
% fn main() {
%     let builder = Command::builder()
%         .executable("lucifer".to_owned())
%         .args(vec![])
%         .env(vec![])
%         .current_dir("target".to_owned())
%         .build()
%         .unwrap();
%     info!("{:#?}", builder);
% }
% \end{code-block}
% \caption{My Func}
% \label{lst:main}
% \end{sourcecode}
%
% Reference to \colorunderlineref{lst:main}

% 大段注释
\begin{comment}
在itemsize/enumerate环境当中嵌入图片的具体用法：

\par\begin{minipage}{\linewidth}
\centering
\includegraphics[width=\linewidth]{cross_finish.png}
\captionof{figure}{交叉编译的结果\protect\footnotemark}
\label{fig:cross_finish}
\end{minipage}
\footnotetext{xxxxx}

在itemsize/enumerate环境当中嵌入其他环境的具体用法：
\begin{minipage}{\linewidth}
  \begin{attention}
  需要注意一下，container\_of在使用的时候，第三个参数应当是结构体当中的
  非指针变量。如果第三个参数是指针变量，则导致在使用时出现错误。
  \end{attention}
\end{minipage}

\end{comment}

\part{语言类}
\include{c}
\include{gcc}
%\include{golang}
\include{rust}
\part{操作系统}
\include{linux}
\include{arm}
\include{rustos}
\include{network}
\include{windows}
\part{消息队列}
\include{zmq}
\part{存储篇}
\include{storage}
\include{ceph}
\part{OpenStack}
\include{mitaka}
\part{Ironic篇}
\include{ironic_introduction}
\include{ironic_install}
\include{ironic_develop}
\include{ironic_architecture}
\include{ironic_images}
\part{容器篇}
\include{docker}
\include{kubernetes}
\include{kubernetes_latest}
\include{kubernetes_usage}

\end{document}
